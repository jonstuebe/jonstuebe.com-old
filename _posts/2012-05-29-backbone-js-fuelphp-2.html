---
layout: post
title: Backbone.js & FuelPHP
categories: []
tags:
- backbone.js
- fuelphp
status: publish
type: post
published: true
meta:
  _wpas_done_all: '1'
  tumblr_jonstuebe_permalink: http://jonstuebe.tumblr.com/post/37430802287/backbone-js-fuelphp
  tumblr_jonstuebe_id: '37430802287'
  _yoast_wpseo_linkdex: '0'
---
<p>Recently I’ve started working with <a href="http://backbonejs.org/" target="_blank">Backbone.js</a> and started to integrate it into <a href="http://fuelphp.com/" target="_blank">FuelPHP</a>, my current framework of choice. Backbone’s sync feature uses a restful set of ajax requests to hook up the javascript mvc to the backend of your choice. In the case of FuelPHP, I had some issues since Fuel’s Validation class uses the POST variables by default, and Backbone sends over all of the variables in a JSON string.<!--more--> To combat this, I’m using the Hybrid Controller with no custom routes. Pretty awesome really. Here’s the start of the controller:</p>

{% highlight php linenos %}
class Controller_Todos extends Controller_Hybrid 
{

	public function action_index()
	{
		$data['todos'] = Model_Todo::find('all');
		$this->template->title = "Todos";
		$this->template->content = View::forge('todos/index', $data);	
	}

	public function get_index()
	{
		if(Input::get('id'))
		{
			$id = Input::get('id');
			$todo = Model_Todo::find($id);
			$this->response($todo);
		}
		else
		{
			$todos = Model_Todo::find('all');
			$this->response($todos);
		}
	}

	public function post_index()
	{
		$val = Model_Todo::validate('create');
		
		if ($val->run(Input::json()))
		{
			$todo = Model_Todo::forge(array(
				'title' => Input::json('title'),
				'description' => Input::json('description'),
				'completed' => Input::json('completed'),
			));

			if ($todo and $todo->save())
			{
				$this->response($todo);
			}

			else
			{
				$this->response(array(
					'error' => true,
				));
			}
		}
	}{% endhighlight %}
